# IHW_OS_3

### Фролов Александр Сергеевич БПИ217

### Вариант 12

### Работа выполнялась на 8 баллов

Задача о гостинице – 1. 
В гостинице 30 номеров, гости гостиницы снимают номер на одни или несколько суток. Если в гостинице нет свободных номеров, гости не уходят, а устраиваются на рядом с гостиницей на скамейках и ждут, пока любой номеров не освободится. Создать приложение, моделирующее работу гостиницы. Сервер — это гостиница. Прибывающие гости могут порождаться отдельным клиентом. Другой клиент — это скамейки, образующие очередь ожидающих гостей.

### Задача на 4-5 баллов

##### Сервер (hotel_server.c):

1) Создается сокет и устанавливается соединение на указанном порту и IP-адресе, которые передаются через аргументы командной строки.

2) Сервер ожидает подключения клиентов и принимает новые соединения.

3) Для каждого подключения создается отдельный поток, обрабатывающий запросы этого клиента.

4) В каждом потоке обрабатываются команды клиента: CHECKIN (заселение в номер), CHECKOUT (выселение) или EXIT (завершение работы клиента).

5) Команда CHECKIN проверяет, есть ли свободные номера. Если есть, то номер заселяется, иначе клиент ожидает, пока освободится номер, и заселяется после этого.

6) Команда CHECKOUT освобождает номер.

7) Команда EXIT завершает работу клиента.

##### Клиент (hotel_client.c):

1) Создается сокет и устанавливается соединение с сервером на указанном порту и IP-адресе, которые передаются через аргументы командной строки.

2) Клиент ожидает ввода команд от пользователя.

3) Введенная команда отправляется на сервер для обработки.

4) Клиент принимает ответ от сервера и выводит его на экран.

5) Процесс повторяется, пока не будет введена команда EXIT для завершения работы клиента.

Итог: сервер обрабатывает запросы от нескольких клиентов, управляет доступностью номеров в гостинице и оповещает клиентов о доступности номеров, если они были заняты. Клиент может взаимодействовать с гостиницей, отправляя команды на сервер и получая ответы о результатах операций.

Запуск программы:

Для сервера:

gcc server.c -o server -lpthread
./server <server_ip> <server_port>

Для сервера:

gcc hotel_server.c -o server -lpthread
./server <server_ip> <server_port>

Для клиента:

gcc hotel_client.c -o client -lpthread
./client <client_ip> <client_port>

### Задача на 6-7 баллов:

В дополнение к предыдущему была реализована клиентская программа для мониторинга поведения сервера и клиентов, подключаемая к серверу.

Для создания этой программы использовались сокеты и межпроцессное взаимодействие (IPC) для связи между клиентом и сервером.

Схема работы: 

Клиентская программа подключается к серверу и ожидает обновлений от него. Когда сервер отправляет обновление, клиентская программа выводит его на экран.

Клиентская программа для мониторинга так же выводит информацию о гостинице:  количество свободных и занятых номеров.

Основные шаги работы клиентской программы:

При запуске клиентской программы пользователь должен указать IP-адрес и порт сервера в аргументах командной строки.

Схема работы клиентской программы для мониторинга: 

Клиент создает сокет и устанавливает соединение с сервером, используя указанный IP-адрес и порт.

После установления соединения, клиент ждет обновлений от сервера.

Когда клиент получает обновление от сервера, он извлекает информацию о состоянии гостиницы из полученных данных.

Клиент отображает информацию о состоянии гостиницы, включая общее количество номеров, количество занятых номеров и количество доступных номеров.

Цикл ожидания и отображения обновленной информации о состоянии гостиницы повторяется, пока соединение с сервером не будет прервано или клиент не будет закрыт.

Для сервера:

gcc hotel_server.c -o server -lpthread
./server <server_ip> <server_port>

Для клиента:

gcc hotel_client.c -o client -lpthread
./client <client_ip> <client_port>

Для клиента-наблюдателя:

gcc client_monitoring.c -o monitor -lpthread
./monitor <monitor_ip> <monitor_port>

### Задача на 8 баллов:

В дополнение к предыдущей программе была реализована возможность подключения нескоьких клиентов, обеспечивающих отображение информации о работе приложения. При этом клиентов-наблюдателей можно отключать и подключать снова в динамическом режиме без нарушения работы всего приложения.

Результат достигается за счёт того, что каждый раз, когда новый клиент подключается к серверу, создается новый поток для обработки его соединения. Это позволяет обрабатывать подключения от множества клиентов независимо и одновременно.

gcc hotel_server.c -o server -lpthread
./server <server_ip> <server_port> <monitor_ip> <monitor_port>

Для клиента:

gcc hotel_client.c -o client
./client <server_ip> <server_port> <guest_id>

Для клиента-наблюдателя:

gcc client_monitoring.c -o client_monitoring
./client_monitoring <server_ip> <server_port>

